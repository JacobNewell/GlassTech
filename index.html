<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>–§–æ—Ä–º–∞ –¥–ª—è –∞–≤—Ç–æ</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }

    form {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      max-width: 400px;
      margin: auto;
    }

    input, textarea {
      display: block;
      margin-bottom: 10px;
      width: 100%;
      padding: 8px;
    }

    button {
      padding: 10px;
      background: #2b8aed;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    fieldset {
      margin-bottom: 15px;
      border: none;
      padding: 0;
    }

    legend {
      margin-bottom: 10px;
      font-weight: bold;
    }

    .checkbox-grid, .radio-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px 16px;
    }

    .checkbox-grid label, .radio-grid label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #f0f0f0;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 14px;
    }

    #equipmentBlock {
      transition: opacity 0.3s ease;
      opacity: 0.3;
      pointer-events: none;
    }

    #equipmentBlock.visible {
      opacity: 1;
      pointer-events: auto;
    }
	
	.header-wrap {
	  max-width: 400px;
	  margin: auto;
	  text-align: center;
	}
  </style>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

<h2 class="header-wrap">–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∞–≤—Ç–æ</h2>
<form id="carForm">
  <input type="text" name="brand" placeholder="–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ" required />
  <input type="text" name="model" placeholder="–ú–æ–¥–µ–ª—å –∞–≤—Ç–æ" required />
  <input type="number" name="year" placeholder="–†—ñ–∫ –≤–∏–ø—É—Å–∫—É" required />
  <input type="text" name="bodyType" placeholder="–í–∏–¥ –∫—É–∑–æ–≤–∞" required />

  <fieldset>
    <legend>–¢–∏–ø —Å–∫–ª–∞, —â–æ –ø–æ—Ç—Ä–µ–±—É—î –∑–∞–º—ñ–Ω–∏:</legend>
    <div class="radio-grid">
      <label>–õ–æ–±–æ–≤–µ <input type="radio" name="glassType" value="–õ–æ–±–æ–≤–µ" required /></label>
      <label>–ó–∞–¥–Ω—î <input type="radio" name="glassType" value="–ó–∞–¥–Ω—î" /></label>
      <label>–ë–æ–∫–æ–≤–µ <input type="radio" name="glassType" value="–ë–æ–∫–æ–≤–µ" /></label>
    </div>
  </fieldset>

  <fieldset id="equipmentBlock">
    <legend>–ù–∞—è–≤–Ω—ñ—Å—Ç—å –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è:</legend>
    <div class="checkbox-grid">
      <label>–î–∞—Ç—á–∏–∫ –¥–æ—â—É <input type="checkbox" name="options" value="–î–∞—Ç—á–∏–∫ –¥–æ—â—É" /></label>
      <label>–ó–∞–≥–∞–ª—å–Ω–∏–π –æ–±—ñ–≥—Ä—ñ–≤ <input type="checkbox" name="options" value="–ó–∞–≥–∞–ª—å–Ω–∏–π –æ–±—ñ–≥—Ä—ñ–≤" /></label>
      <label>–û–±—ñ–≥—Ä—ñ–≤ –¥–≤—ñ—Ä–Ω–∏–∫—ñ–≤ <input type="checkbox" name="options" value="–û–±—ñ–≥—Ä—ñ–≤ –¥–≤—ñ—Ä–Ω–∏–∫—ñ–≤" /></label>
      <label>–ö–∞–º–µ—Ä–∞ <input type="checkbox" name="options" value="–ö–∞–º–µ—Ä–∞" /></label>
      <label>–ê–Ω—Ç–µ–Ω–∞ <input type="checkbox" name="options" value="–ê–Ω—Ç–µ–Ω–∞" /></label>
      <label>–ù—ñ—á–æ–≥–æ –∑ –ø–µ—Ä–µ–ª—ñ—á–µ–Ω–æ–≥–æ <input type="checkbox" name="options" value="–ù—ñ—á–æ–≥–æ –∑ –ø–µ—Ä–µ–ª—ñ—á–µ–Ω–æ–≥–æ" id="noneOption" /></label>
    </div>
  </fieldset>

  <label>–ü–æ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ, –ø—Ä–∏–∫—Ä—ñ–ø—ñ—Ç—å —á—ñ—Ç–∫–µ —Ñ–æ—Ç–æ –∞–≤—Ç–æ –∑ –≤—É–ª–∏—Ü—ñ:</label>
  <input type="file" name="photo" id="photoInput" accept="image/*" />

  <button type="submit">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
</form>

<script>
  window.Telegram.WebApp.ready();

  const botToken = "7383504698:AAEsV0m8H2KhqlrefNCimaT3Jk14qQEAsEo";
  const groupChatId = "1463281290";

  document.querySelectorAll('input[name="glassType"]').forEach(el => {
    el.addEventListener('change', () => {
      const block = document.getElementById('equipmentBlock');
      if (el.value === '–õ–æ–±–æ–≤–µ') {
        block.classList.add('visible');
      } else {
        block.classList.remove('visible');
        document.querySelectorAll('#equipmentBlock input[type="checkbox"]').forEach(c => c.checked = false);
      }
    });
  });

  document.getElementById('noneOption').addEventListener('change', function () {
    if (this.checked) {
      document.querySelectorAll('input[name="options"]').forEach(el => {
        if (el !== this) el.checked = false;
      });
    }
  });
  document.querySelectorAll('input[name="options"]').forEach(el => {
    if (el.id !== 'noneOption') {
      el.addEventListener('change', () => {
        if (el.checked) {
          document.getElementById('noneOption').checked = false;
        }
      });
    }
  });

  document.getElementById('carForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const form = new FormData(e.target);

    const selectedOptions = Array.from(document.querySelectorAll('input[name="options"]:checked'))
      .map(el => el.value)
      .join(', ') || '–ù–µ –æ–±—Ä–∞–Ω–æ';

    const selectedGlassType = document.querySelector('input[name="glassType"]:checked')?.value || '–ù–µ –≤–∫–∞–∑–∞–Ω–æ';

    const now = new Date();
    const formattedDate = now.toLocaleDateString('uk-UA');
    const formattedTime = now.toLocaleTimeString('uk-UA');

    let authorLink = 'üßë –ö–ª—ñ—î–Ω—Ç: –ù–µ –≤–∏–∑–Ω–∞—á–µ–Ω–æ';
    if (window.Telegram.WebApp.initDataUnsafe?.user) {
      const tgUser = window.Telegram.WebApp.initDataUnsafe.user;
      authorLink = tgUser?.username
        ? `üßë –ö–ª—ñ—î–Ω—Ç: [${tgUser.first_name}](https://t.me/${tgUser.username})`
        : tgUser?.first_name
          ? `üßë –ö–ª—ñ—î–Ω—Ç: ${tgUser.first_name} (–±–µ–∑ username)`
          : `üßë –ö–ª—ñ—î–Ω—Ç: –ù–µ –≤–∏–∑–Ω–∞—á–µ–Ω–æ`;
    }

    const messageText = `
üöó *–ù–æ–≤–∞ –∑–∞—è–≤–∫–∞:*  
${authorLink}  
*–ú–∞—Ä–∫–∞:* ${form.get('brand')}  
*–ú–æ–¥–µ–ª—å:* ${form.get('model')}  
*–†—ñ–∫:* ${form.get('year')}  
*–ö—É–∑–æ–≤:* ${form.get('bodyType')}  
*–¢–∏–ø —Å–∫–ª–∞:* ${selectedGlassType}  
*–ù–∞—è–≤–Ω—ñ—Å—Ç—å –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è:* ${selectedGlassType === '–õ–æ–±–æ–≤–µ' ? selectedOptions : '–ù–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ'}  
üìÖ *–î–∞—Ç–∞:* ${formattedDate}  
‚è∞ *–ß–∞—Å:* ${formattedTime}
    `.trim();

    const photoFile = document.getElementById('photoInput').files[0];

    if (photoFile) {
      const formDataToSend = new FormData();
      formDataToSend.append("chat_id", groupChatId);
      formDataToSend.append("caption", messageText);
      formDataToSend.append("photo", photoFile);

      await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
        method: 'POST',
        body: formDataToSend
      });
    } else {
      await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          chat_id: groupChatId,
          text: messageText,
          parse_mode: "Markdown"
        })
      });
    }

    alert('–§–æ—Ä–º–∞ —É—Å–ø—ñ—à–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∞! –î—è–∫—É—î–º–æ üòä');
  });
</script>

</body>
</html>
